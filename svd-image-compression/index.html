<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVD Image Compression - Ma Tr·∫≠n N√©n ·∫¢nh</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <!-- SCREEN 1: Welcome + Upload -->
        <div id="screen-welcome" class="screen active">
            <div class="header">
                <h1>üñºÔ∏è MA TR·∫¨N N√âN ·∫¢NH</h1>
                <p class="subtitle">Singular Value Decomposition (SVD)</p>
            </div>

            <div class="intro-section">
                <div class="math-preview">
                    <div class="matrix-equation">
                        <span class="matrix">A</span>
                        <span class="equals">=</span>
                        <span class="matrix highlight-u">U</span>
                        <span class="times">√ó</span>
                        <span class="matrix highlight-sigma">Œ£</span>
                        <span class="times">√ó</span>
                        <span class="matrix highlight-v">V·µÄ</span>
                    </div>
                </div>

                <div class="intro-steps">
                    <div class="step">
                        <span class="step-icon">üì∑</span>
                        <span class="step-text">M·ªói ·∫£nh l√† m·ªôt <strong>ma tr·∫≠n s·ªë</strong></span>
                    </div>
                    <div class="step">
                        <span class="step-icon">‚úÇÔ∏è</span>
                        <span class="step-text">SVD t√°ch ma tr·∫≠n ‚Üí gi·ªØ <strong>ph·∫ßn quan tr·ªçng</strong></span>
                    </div>
                    <div class="step">
                        <span class="step-icon">üì¶</span>
                        <span class="step-text">K·∫øt qu·∫£: ·∫¢nh <strong>nh·ªè h∆°n 90%</strong> v·∫´n r√µ!</span>
                    </div>
                </div>
            </div>

            <div class="upload-section">
                <input type="file" id="file-input" accept="image/*" style="display:none;">
                <label for="file-input" class="upload-box" id="upload-box">
                    <div class="upload-content">
                        <span class="upload-icon">üìÅ</span>
                        <p class="upload-text">Ch·ªçn ·∫£nh ho·∫∑c k√©o th·∫£ v√†o ƒë√¢y</p>
                        <p class="upload-hint">PNG, JPG, JPEG</p>
                    </div>
                </label>

                <div class="sample-images">
                    <p class="sample-title">Ho·∫∑c ch·ªçn ·∫£nh m·∫´u:</p>
                    <div class="sample-grid">
                        <div class="sample-item" data-sample="gradient">
                            <div class="sample-preview gradient-sample"></div>
                            <span>Gradient</span>
                        </div>
                        <div class="sample-item" data-sample="checkerboard">
                            <div class="sample-preview checker-sample"></div>
                            <span>Checkerboard</span>
                        </div>
                        <div class="sample-item" data-sample="circles">
                            <div class="sample-preview circles-sample"></div>
                            <span>Circles</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- SCREEN 2: Confirm & Start -->
        <div id="screen-size" class="screen">
            <div class="header-small">
                <button class="btn-back" id="btn-back-size">‚Üê Quay l·∫°i</button>
                <h2>üìê X√°c nh·∫≠n ·∫£nh</h2>
            </div>

            <div class="image-info-card">
                <div class="original-preview">
                    <img id="preview-original" src="" alt="Preview">
                </div>
                <div class="image-details">
                    <div class="detail-row">
                        <span class="detail-label">K√≠ch th∆∞·ªõc g·ªëc:</span>
                        <span class="detail-value" id="original-size">-</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">X·ª≠ l√Ω:</span>
                        <span class="detail-value">200 √ó 200</span>
                    </div>
                </div>
            </div>

            <div class="size-options">
                <div class="color-mode-toggle">
                    <span class="toggle-label">Ch·∫ø ƒë·ªô m√†u:</span>
                    <div class="toggle-buttons">
                        <button class="toggle-btn active" data-mode="grayscale">‚¨õ Grayscale</button>
                        <button class="toggle-btn" data-mode="color">üåà Color</button>
                    </div>
                </div>
            </div>

            <button id="btn-start-compress" class="btn-primary">
                üöÄ B·∫ÆT ƒê·∫¶U N√âN ·∫¢NH
            </button>
        </div>

        <!-- SCREEN 3: Processing -->
        <div id="screen-processing" class="screen">
            <div class="processing-content">
                <div class="processing-animation">
                    <div class="matrix-anim">
                        <span class="m-a">A</span>
                        <span class="m-eq">=</span>
                        <span class="m-u">U</span>
                        <span class="m-s">Œ£</span>
                        <span class="m-v">V·µÄ</span>
                    </div>
                </div>
                <h2 id="processing-title">ƒêang ph√¢n t√≠ch ma tr·∫≠n...</h2>
                <p id="processing-status">T√≠nh to√°n SVD cho ·∫£nh <span id="proc-size">200√ó200</span></p>
                <div class="progress-container">
                    <div class="progress-bar" id="proc-progress"></div>
                </div>
                <p class="processing-hint" id="processing-hint">Vui l√≤ng ch·ªù trong gi√¢y l√°t...</p>
            </div>
        </div>

        <!-- SCREEN 4: Result / Interactive -->
        <div id="screen-result" class="screen">
            <div class="header-small">
                <button class="btn-back" id="btn-back-result">‚Üê ·∫¢nh kh√°c</button>
                <h2>üéõÔ∏è ƒêi·ªÅu ch·ªânh n√©n ·∫£nh</h2>
            </div>

            <div class="comparison-container">
                <div class="image-card">
                    <div class="image-label">·∫¢NH G·ªêC</div>
                    <canvas id="canvas-original"></canvas>
                    <div class="image-stats">
                        <span id="stats-original-size">200 √ó 200</span>
                    </div>
                </div>
                <div class="image-card">
                    <div class="image-label">·∫¢NH N√âN (SVD)</div>
                    <canvas id="canvas-compressed"></canvas>
                    <div class="image-stats">
                        <span id="stats-k">k = 50</span>
                    </div>
                </div>
            </div>

            <div class="slider-section">
                <div class="slider-header">
                    <span class="slider-label">S·ªë Singular Values (k):</span>
                    <span class="slider-value" id="k-value">50</span>
                    <span class="slider-max">/ <span id="k-max">200</span></span>
                </div>
                <input type="range" id="k-slider" min="1" max="200" value="50" class="slider">
                <div class="slider-hints">
                    <span>N√©n nhi·ªÅu (m·ªù)</span>
                    <span>N√©n √≠t (r√µ)</span>
                </div>
            </div>

            <div class="preset-buttons">
                <button class="preset-btn" data-k="1">k=1</button>
                <button class="preset-btn" data-k="5">k=5</button>
                <button class="preset-btn" data-k="10">k=10</button>
                <button class="preset-btn" data-k="20">k=20</button>
                <button class="preset-btn" data-k="50">k=50</button>
                <button class="preset-btn" data-k="100">k=100</button>
                <button class="preset-btn" data-k="max">Full</button>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üìä</div>
                    <div class="stat-info">
                        <span class="stat-label">T·ªâ l·ªá n√©n</span>
                        <span class="stat-value" id="compression-ratio">50%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üéØ</div>
                    <div class="stat-info">
                        <span class="stat-label">PSNR</span>
                        <span class="stat-value" id="psnr-value">30 dB</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚ö°</div>
                    <div class="stat-info">
                        <span class="stat-label">Energy</span>
                        <span class="stat-value" id="energy-value">95%</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üíæ</div>
                    <div class="stat-info">
                        <span class="stat-label">Th·ªùi gian SVD</span>
                        <span class="stat-value" id="svd-time">1.2s</span>
                    </div>
                </div>
            </div>

            <div class="explanation-card">
                <h3>üí° Gi·∫£i th√≠ch</h3>
                <p id="explanation-text">
                    V·ªõi <strong>k = 50</strong>, ta ch·ªâ gi·ªØ <strong>50 singular values</strong> l·ªõn nh·∫•t.
                    Ma tr·∫≠n g·ªëc <strong>200√ó200 = 40,000</strong> s·ªë ƒë∆∞·ª£c bi·ªÉu di·ªÖn b·∫±ng
                    <strong>50√ó(200+200+1) = 20,050</strong> s·ªë ‚Üí ti·∫øt ki·ªám <strong>50%</strong> d·ªØ li·ªáu!
                </p>
            </div>

            <button id="btn-show-math" class="btn-secondary">
                üìê Xem chi ti·∫øt To√°n h·ªçc
            </button>
        </div>

        <!-- SCREEN 5: Math Details (Optional) -->
        <div id="screen-math" class="screen">
            <div class="header-small">
                <button class="btn-back" id="btn-back-math">‚Üê Quay l·∫°i</button>
                <h2>üìê Chi ti·∫øt To√°n h·ªçc</h2>
            </div>

            <div class="math-section">
                <div class="math-card">
                    <h3>C√¥ng th·ª©c SVD</h3>
                    <div class="formula">
                        A<sub>m√ón</sub> = U<sub>m√óm</sub> √ó Œ£<sub>m√ón</sub> √ó V<sup>T</sup><sub>n√ón</sub>
                    </div>
                    <ul class="math-list">
                        <li><strong>A</strong>: Ma tr·∫≠n ·∫£nh g·ªëc (m √ó n pixels)</li>
                        <li><strong>U</strong>: Ma tr·∫≠n tr·ª±c giao tr√°i</li>
                        <li><strong>Œ£</strong>: Ma tr·∫≠n ƒë∆∞·ªùng ch√©o (singular values)</li>
                        <li><strong>V<sup>T</sup></strong>: Ma tr·∫≠n tr·ª±c giao ph·∫£i (chuy·ªÉn v·ªã)</li>
                    </ul>
                </div>

                <div class="math-card">
                    <h3>N√©n ·∫£nh v·ªõi k singular values</h3>
                    <div class="formula">
                        A<sub>k</sub> = U<sub>k</sub> √ó Œ£<sub>k</sub> √ó V<sub>k</sub><sup>T</sup>
                    </div>
                    <p>Ch·ªâ gi·ªØ <strong>k</strong> singular values l·ªõn nh·∫•t:</p>
                    <ul class="math-list">
                        <li>D·ªØ li·ªáu l∆∞u: k √ó (m + n + 1) thay v√¨ m √ó n</li>
                        <li>k c√†ng nh·ªè ‚Üí n√©n c√†ng nhi·ªÅu ‚Üí m·∫•t chi ti·∫øt</li>
                        <li>k c√†ng l·ªõn ‚Üí n√©n √≠t ‚Üí gi·ªØ chi ti·∫øt</li>
                    </ul>
                </div>

                <div class="math-card">
                    <h3>Singular Values c·ªßa ·∫£nh hi·ªán t·∫°i</h3>
                    <canvas id="canvas-sv-chart" height="200"></canvas>
                    <p class="chart-note">Bi·ªÉu ƒë·ªì cho th·∫•y singular values gi·∫£m nhanh ‚Üí ch·ªâ c·∫ßn gi·ªØ m·ªôt s·ªë √≠t!</p>
                </div>
            </div>
        </div>

        <!-- Loading overlay -->
        <div id="loading-overlay" class="loading-overlay">
            <div class="loading-spinner"></div>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>
